<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Podcast Listening Time Predictor</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @keyframes scale-in {
        from {
          transform: scale(0.8);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }
      .animate-scale-in {
        animation: scale-in 0.3s ease-out;
      }
      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url("https://imgs.search.brave.com/Y8gMkjgLUXHhQcPXcYVnyTV_zQNwDlORu4aHHGWyueg/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9jb2xl/bWFuaW5zaWdodHMu/Y29tL3dwLWNvbnRl/bnQvdXBsb2Fkcy8y/MDIzLzA1L21pY3Jv/cGhvbmUuanBn");
        background-size: cover;
        background-position: center;
      }
    </style>
  </head>
  <body class="min-h-screen flex flex-col relative">
    <!-- Home Button in top-right corner -->
    <a
      href="{{ url_for('back') }}"
      class="fixed top-4 right-4 flex items-center gap-2 bg-white bg-opacity-90 hover:bg-opacity-100 text-blue-700 font-semibold px-4 py-2 rounded-full shadow-lg transition"
      title="Go to Home"
    >
      <i class="fa-solid fa-house"></i>
      Home
    </a>

    <!-- MAIN FORM -->
    <main class="flex-1 flex items-center justify-center p-6">
      <div
        class="bg-white/90 backdrop-blur-sm shadow-xl rounded-2xl p-6 w-full max-w-3xl transition-all duration-500 hover:shadow-blue-200 border border-gray-200"
      >
        <!-- Centered Title -->
        <div class="flex flex-col items-center mb-6">
          <img
            src="https://cdn-icons-png.flaticon.com/512/2920/2920265.png"
            alt="Podcast Icon"
            class="w-12 h-12 mb-2 animate-bounce"
          />
          <h2 class="text-2xl font-extrabold text-blue-700 text-center">
            ðŸŽ™ Podcast Listening Time Predictor
          </h2>
          <p class="text-gray-600 text-sm text-center mt-1">
            Enter your podcast details below to get an AI-powered prediction.
          </p>
        </div>

        <!-- Form -->
        <form id="predictForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Full width fields -->
          <input
            type="text"
            name="podcast_name"
            placeholder="Podcast Name"
            required
            class="col-span-2 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 focus:outline-none transition duration-300 hover:shadow bg-white/80"
          />

          <input
            type="text"
            name="episode_title"
            placeholder="Episode Title"
            required
            class="col-span-2 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 focus:outline-none transition duration-300 hover:shadow bg-white/80"
          />

          <!-- Two columns -->
          <input
            type="number"
            step="0.01"
            name="episode_length"
            placeholder="Episode Length (min)"
            required
            class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 focus:outline-none transition duration-300 hover:shadow bg-white/80"
          />

          <input
            type="number"
            step="0.01"
            name="guest_popularity"
            placeholder="Guest Popularity (%)"
            required
            class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 focus:outline-none transition duration-300 hover:shadow bg-white/80"
          />

          <input
            type="number"
            step="0.01"
            name="host_popularity"
            placeholder="Host Popularity (%)"
            required
            class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 focus:outline-none transition duration-300 hover:shadow bg-white/80"
          />

          <input
            type="number"
            name="num_ads"
            placeholder="Number of Ads"
            required
            class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 focus:outline-none transition duration-300 hover:shadow bg-white/80"
          />

          <select
            name="genre"
            required
            class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 focus:outline-none transition duration-300 hover:shadow bg-white/80"
          >
            <option value="" disabled selected class="text-gray-400">
              Select Genre
            </option>
            <option>Comedy</option>
            <option>Education</option>
            <option>Technology</option>
            <option>Health</option>
            <option>News</option>
            <option>Music</option>
            <option>Sports</option>
            <option>Business</option>
            <option>Lifestyle</option>
            <option>True Crime</option>
          </select>

          <select
            name="publication_day"
            required
            class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 focus:outline-none transition duration-300 hover:shadow bg-white/80"
          >
            <option value="" disabled selected class="text-gray-400">
              Select Publication Day
            </option>
            <option>Monday</option>
            <option>Tuesday</option>
            <option>Wednesday</option>
            <option>Thursday</option>
            <option>Friday</option>
            <option>Saturday</option>
            <option>Sunday</option>
          </select>

          <select
            name="publication_time"
            required
            class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 focus:outline-none transition duration-300 hover:shadow bg-white/80"
          >
            <option value="" disabled selected class="text-gray-400">
              Select Publication Time
            </option>
            <option>Morning</option>
            <option>Afternoon</option>
            <option>Evening</option>
            <option>Night</option>
          </select>

          <select
            name="episode_sentiment"
            required
            class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 focus:outline-none transition duration-300 hover:shadow bg-white/80"
          >
            <option value="" disabled selected class="text-gray-400">
              Select Episode Sentiment
            </option>
            <option>Positive</option>
            <option>Negative</option>
            <option>Neutral</option>
          </select>

          <!-- Submit button -->
          <button
            type="submit"
            class="col-span-2 bg-gradient-to-r from-indigo-600 to-blue-600 hover:from-indigo-700 hover:to-blue-700 text-white font-semibold py-3 rounded-lg transition-all duration-300 transform hover:scale-[1.02] shadow"
          >
            ðŸ”® Predict Listening Time
          </button>
        </form>
      </div>
    </main>

    <!-- FOOTER -->
    <footer class="bg-gray-800/90 text-white text-center py-4 text-sm">
      &copy; 2025 AI Podcast Listening Time Predictor | Sahan Wijerathne | All
      rights reserved.
    </footer>

    <!-- Modal -->
    <div
      id="predictionModal"
      class="fixed inset-0 bg-black/50 hidden items-center justify-center"
    >
      <div
        class="bg-white rounded-xl shadow-lg p-8 max-w-sm w-full text-center animate-scale-in border border-gray-200"
      >
        <h2 class="text-xl font-bold text-indigo-700 mb-4">
          ðŸŽ¯ Predicted Listening Time
        </h2>
        <div class="flex items-center justify-center mb-6">
          <p
            id="predictionText"
            class="text-lg font-semibold text-gray-700 whitespace-nowrap"
          >
            Loading...
          </p>
        </div>
        <button
          onclick="location.reload()"
          class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg shadow-md transition"
        >
          OK
        </button>
      </div>
    </div>

    <!-- JavaScript -->
    <script>
      document
        .getElementById("predictForm")
        .addEventListener("submit", async function (event) {
          event.preventDefault();
          const formData = new FormData(this);
          try {
            const response = await fetch("http://127.0.0.1:5000/predict", {
              method: "POST",
              body: formData,
            });

            if (!response.ok)
              throw new Error(`Server error: ${response.status}`);

            const result = await response.json();
            document.getElementById("predictionText").innerText =
              result.prediction;
            document
              .getElementById("predictionModal")
              .classList.remove("hidden");
            document.getElementById("predictionModal").classList.add("flex");
          } catch (error) {
            alert("Error fetching prediction: " + error.message);
          }
        });
    </script>
  </body>
</html>
